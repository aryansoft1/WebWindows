<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8" />
    <title>
        ÊàêÈÉΩ‰∫öÂéüËΩØ‰ª∂ÊúâÈôêÂÖ¨Âè∏-È¶ñÈ°µ
    </title>
    <link href="assets/icons/logo_large.png" rel="icon" />
    <link href="widgets/weather_time_widget.css" rel="stylesheet" />
    <link href="assets/css/context_menu.css" rel="stylesheet" />
    <script defer="" src="widgets/weather_time_widget_v3.js"></script>
    <link href="assets/css/main.css" rel="stylesheet" />
    <script defer="True" src="assets/js/main.js"></script>
    <script defer="True" src="assets/js/snap_drag.js"></script>
</head>
<body onload="makeDesktopIconsDraggable();enterFullscreen();initUserStatus();">
    <div class="desktop">
        <div class="power-menu" id="power-menu" style="display:none">
            <div class="power-item" onclick="document.getElementById('power-menu').style.display = 'none'">
                <span class="emoji">
                    üîí
                </span>
                <span>
                    ÈîÅÂÆö
                </span>
            </div>
            <div class="power-item" onclick="document.getElementById('power-menu').style.display = 'none'">
                <span class="emoji">
                    üåô
                </span>
                <span>
                    ‰ºëÁú†
                </span>
            </div>
            <div class="power-item" onclick="shutdownSystem()">
                <span class="emoji">
                    ‚èª
                </span>
                <span>
                    ÂÖ≥Èó≠
                </span>
            </div>
            <div class="power-item" onclick="sessionStorage.removeItem('booted'); location.reload()">
                <span class="emoji">
                    üîÑ
                </span>
                <span>
                    ÈáçÊñ∞ÂêØÂä®
                </span>
            </div>
        </div>
        <div class="icon" id="web" onclick="openWindow('web', 'ÁΩëÁ´ôÂª∫ËÆæ', 'web.html', 'assets/icons/web.png')">
            <img src="assets/icons/web.png" />
            <label>
                ÁΩëÁ´ôÂª∫ËÆæ
            </label>
        </div>
        <div class="icon" id="cloud" onclick="openWindow('cloud', '‰∫ëÊúçÂä°', 'cloud.html', 'assets/icons/cloud.png')">
            <img src="assets/icons/cloud.png" />
            <label>
                ‰∫ëÊúçÂä°
            </label>
        </div>
        <div class="icon" id="yunmishu" onclick="openWindow('yunmishu_root', '‰∫ëÁßò‰π¶', '', 'assets/icons/cloud_secretary.png')">
            <img src="assets/icons/cloud_secretary.png" />
            <label>
                ‰∫ëÁßò‰π¶
            </label>
        </div>
        <div class="icon" id="software" onclick="openWindow('software', 'ËΩØ‰ª∂ÂºÄÂèë', 'software.html', 'assets/icons/code.png')">
            <img src="assets/icons/code.png" />
            <label>
                ËΩØ‰ª∂ÂºÄÂèë
            </label>
        </div>
        <div class="icon" id="japan" onclick="openWindow('japan', 'ÂØπÊó•Â§ñÂåÖ', 'japan.html', 'assets/icons/japan.png')">
            <img src="assets/icons/japan.png" />
            <label>
                ÂØπÊó•Â§ñÂåÖ
            </label>
        </div>
        <div class="icon" id="news" onclick="openWindow('news', 'Êñ∞Èóª‰∏≠ÂøÉ', 'news.html', 'assets/icons/news.png')">
            <img src="assets/icons/news.png" />
            <label>
                Êñ∞Èóª‰∏≠ÂøÉ
            </label>
        </div>
        <div class="icon" id="contact" onclick="openWindow('contact', 'ËÅîÁ≥ªÊàë‰ª¨', 'contact.html', 'assets/icons/contact.png')">
            <img src="assets/icons/contact.png" />
            <label>
                ËÅîÁ≥ªÊàë‰ª¨
            </label>
        </div>
        <div class="icon no-auto" id="sheeteditor" onclick="openWindow('SheetEditor', 'Worker SheetEditor' , 'worker_SheetCreater.html', 'assets/icons/sheeteditor.png', true)">
            <img src="assets/icons/sheeteditor.png" />
            <label>Sheet Editor</label>
        </div>

    </div>
    <div class="taskbar">
        <div id="taskbar-datetime" onclick="toggleCalendar()">
            <div id="clock-time">
                --:--
            </div>
            <div id="clock-date">
                ----/--/--
            </div>
        </div>
        <div class="start-button" onclick="toggleStartMenu()">
            <img alt="ÂºÄÂßã" src="assets/icons/logo_large.png" />
        </div>
    </div>
    <!-- Weather & Time Widget -->
    <div class="weather-widget" id="weatherTimeWidget">
        <div class="weather-header">
            <span id="weather-location">
                Loading...
            </span>
            <button id="closeWeatherBtn">
                ‚úï
            </button>
        </div>
        <div class="weather-info">
            <img alt="Weather" id="weather-icon" src="" />
            <div>
                <div id="weather-temp">
                    --¬∞C
                </div>
                <div id="weather-desc">
                    Loading...
                </div>
            </div>
        </div>
        <div class="time-info">
            <div id="local-time">
                --:--
            </div>
        </div>
    </div>
    <!-- È°µËÑöÁâàÊùÉ‰ø°ÊÅØ -->
    <div id="desktop-footer">
    </div>
    <script src="widgets/context_menu.js"></script>
    <div id="calendar-popup">
        <header>
            <button id="prev-month">
                ‚Üê
            </button>
            <h4 id="calendar-header">
                ...
            </h4>
            <button id="next-month">
                ‚Üí
            </button>
        </header>
        <div class="days" id="calendar-days">
        </div>
    </div>
    <!-- È°µËÑöÁâàÊùÉ‰ø°ÊÅØ -->
    <div id="desktop-footer" style="
  position: fixed;
  right: 16px;
  bottom: 52px;
  color: white;
  font-size: 12px;
  z-index: 9999;
  opacity: 0.8;
  pointer-events: none;">
    </div>
    <!-- Win11 Start Menu -->
    <!-- Win11 ‰∏≠ÊñáÂºÄÂßãËèúÂçï -->
    <div id="start-menu">
        <div id="start-menu-login" style="cursor:default; display: flex; align-items: center; justify-content: space-between; padding: 8px 12px; border-bottom: 1px solid #ddd; background: #f8f8f8; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; font-size: 14px;">
    <div style="display: flex; align-items: center;">
  <img id="login-avatar" src="assets/icons/149071.png" alt="avatar" style="width: 28px; height: 28px; border-radius: 50%; margin-right: 8px;">
  <span id="login-username">Á∫ø‰∏ãÁî®Êà∑</span>
  <span id="login-status" style="width: 8px; height: 8px; background: #cc8800; border-radius: 50%; display: inline-block; margin-left: 6px;"></span>
</div>
    <button class="power-btn"  onclick="togglePowerMenu();" style="background: none; border: none; font-size: 16px; cursor: pointer;">
      ‚èª
    </button>
  </div>
<div id="user-popup" class="absolute bottom-14 left-3 bg-white shadow-xl border rounded-md w-40 p-2 hidden z-50">
  <div class="text-sm text-center mb-2 text-gray-700">admin</div>
  <button onclick="logout()" class="w-full text-red-600 hover:text-white hover:bg-red-500 py-1 rounded">
    Ê≥®ÈîÄ
  </button>
</div>

        <ul>
            <li onclick="openWindow('explorer','‰∫ëËµÑÊñô', 'cloud/browser/files.asp', 'assets/icons/explorer.png', true);document.getElementById('start-menu').style.display='none'">
                <img alt="‰∫ëËµÑÊñô" src="assets/icons/explorer.png" />
                <span>
                    ‰∫ëËµÑÊñô
                </span>
            </li>
            <li onclick="openWindow('road','ÈóÆÈÅì', 'road.html', 'assets/icons/wendao.png', true);document.getElementById('start-menu').style.display='none'">
                <img src="assets/icons/wendao.png">
                <span>ÈóÆÈÅì</span>
            </li>
            <li onclick="openWindow('sysinfo', 'Á≥ªÁªü‰ø°ÊÅØ', 'sysinfo.html', 'assets/icons/sysinfo.png');document.getElementById('start-menu').style.display='none'">
                <img alt="Á≥ªÁªü‰ø°ÊÅØ" src="assets/icons/sysinfo.png" />
                <span>
                    Á≥ªÁªü‰ø°ÊÅØ
                </span>
            </li>
            <li onclick="openWindow('yunmishu_root', '‰∫ëÁßò‰π¶', '', 'assets/icons/cloud_secretary.png');document.getElementById('start-menu').style.display='none'">
                <img alt="‰∫ëÁßò‰π¶" src="assets/icons/cloud_secretary.png" />
                <span>
                    ‰∫ëÁßò‰π¶
                </span>
            </li>
            <li onclick="openWindow('edge', 'ÊµèËßàÂô®', 'edge.html', 'assets/icons/edge.png');document.getElementById('start-menu').style.display='none'">
                <img alt="ÊµèËßàÂô®" src="assets/icons/edge.png" />
                <span>
                    ÊµèËßàÂô®
                </span>
            </li>
            <li onclick="openWindow('mail', 'ÈÇÆ‰ª∂', 'mail.html', 'assets/icons/mail.png');document.getElementById('start-menu').style.display='none'">
                <img alt="ÈÇÆ‰ª∂" src="assets/icons/mail.png" />
                <span>
                    ÈÇÆ‰ª∂
                </span>
            </li>
            <li onclick="openWindow('calendar', 'Êó•ÂéÜ', 'calendar.html', 'assets/icons/calendar.png');document.getElementById('start-menu').style.display='none'">
                <img alt="Êó•ÂéÜ" src="assets/icons/calendar.png" />
                <span>
                    Êó•ÂéÜ
                </span>
            </li>
            <li onclick="openWindow('settings', 'ËÆæÁΩÆ', 'settings.html', 'assets/icons/settings.png',true);document.getElementById('start-menu').style.display='none'">
                <img alt="ËÆæÁΩÆ" src="assets/icons/settings.png" />
                <span>
                    ËÆæÁΩÆ
                </span>
            </li>
            <li class="power-btn" >
                <img alt="ÁîµÊ∫ê" src="assets/icons/power.png" />
                <span>
                    ÁîµÊ∫ê
                </span>
            </li>
        </ul>
    </div>
    <div class="context-menu" id="window-context-menu" style="display:none; position:absolute; z-index:2147483648">
        <ul>
            <li onclick="minimizeTargetWindow();">
                ÊúÄÂ∞èÂåñ
            </li>
            <li onclick="maximizeTargetWindow()">
                Áº©Êîæ
            </li>
            <li onclick="closeTargetWindow()">
                ÂÖ≥Èó≠
            </li>
        </ul>
    </div>
    <script src="assets/js/tw.js"></script>
</body>
</html>
